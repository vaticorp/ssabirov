<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TODO</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <style>
        body {
            background-color: lavenderblush;
        }
        .field {
            clear:both; text-align:right; line-height:25px;
        }
    </style>
    <script>
        $(document).ready ( function(){
            refreshTable();
        });
        function addItem() {
            var desc = document.getElementsByName("description")[0].value;
            if (desc == "") {
                alert("Please, enter item description!");
            } else {
                $.ajax({
                    method: 'post',
                    url: "./view",
                    data: {description: desc}
                })
                refreshTable();
            }
            return false;
        }
        function refreshTable() {
            var cb = document.getElementById("all");
            $.ajax({
                method: 'get',
                url: "./view",
                data: {flag: cb.checked},
                complete: function (msg) {
                    console.log(msg.responseText);
                    json = JSON.parse(msg.responseText);
                    var items_elem = document.getElementById("it");
                    var result = "<table border='2' bgcolor='#efefef'>";
                    for (var i = 0; i != json.items.length; i++) {
                        var d = new Date(json.items[i].created);
                        var formattedDate = d.getDate() + "-" + (d.getMonth() + 1) + "-" + d.getFullYear();
                        var hours = (d.getHours() < 10) ? "0" + d.getHours() : d.getHours();
                        var minutes = (d.getMinutes() < 10) ? "0" + d.getMinutes() : d.getMinutes();
                        var formattedTime = hours + ":" + minutes;
                        formattedDate = formattedDate + " " + formattedTime;
                        result += "<tr>" +
                            "<td>" + json.items[i].id + "</td>" +
                            "<td>" + json.items[i].desc + "</td>" +
                            "<td>" + formattedDate + "</td>" +
                            "<td>" + json.items[i].done + "</td>" +
                        "</tr>";
                    }
                    result += "</table>";
                    items_elem.innerHTML = result;
                }
            })
        }
    </script>
</head>
<body>

<fieldset>
    <legend>Создание нового задания</legend>
    <form onsubmit="return addItem();">
        <textarea name="description" cols="20" rows="4">Enter description...</textarea>
        <input class="field" type="submit" value="Add new task">
    </form>
</fieldset>
<h1>Таблица заданий</h1>
<input type="checkbox" id="all" name="all" checked="checked" onclick="refreshTable()"/> Показать все
<form action="${pageContext.servletContext.contextPath}/view" method="get" onsubmit="return refreshTable();">
    <div id="it" class="field">
        <!--тут будет таблица заданий-->
    </div>
</form>

</body>
</html>